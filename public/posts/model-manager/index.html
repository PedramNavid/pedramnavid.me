<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Model Manager :: pedramnavid.me — adventures in data and code</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Finding a way to get models into production seems like a universal problem these days. 1.75 billion results as of last count, with countless companies devoted to solving this in one way or another.
The Problem At Windfall, we used a variety of models built by data scientists to drive our products. The problem was that different people had slightly different ways of building them, and so there was no standard way of running them.
We relied heavily on whoever built the model in order to run it whenever we needed predictions. We also were exploring tying in model predictions directly into our front-end systems." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="/posts/model-manager/" />




<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

  <link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />

  <meta name="twitter:site" content="" />

<meta name="twitter:creator" content="pedram__navid" />


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Model Manager :: pedramnavid.me">
<meta property="og:description" content="Finding a way to get models into production seems like a universal problem these days. 1.75 billion results as of last count, with countless companies devoted to solving this in one way or another.
The Problem At Windfall, we used a variety of models built by data scientists to drive our products. The problem was that different people had slightly different ways of building them, and so there was no standard way of running them.
We relied heavily on whoever built the model in order to run it whenever we needed predictions. We also were exploring tying in model predictions directly into our front-end systems." />
<meta property="og:url" content="/posts/model-manager/" />
<meta property="og:site_name" content="Model Manager" />

  <meta property="og:image" content="/">

<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">


  <meta property="article:published_time" content="2020-04-23 00:00:00 &#43;0000 UTC" />












</head>
<body class="">


<div class="container headings--one-size">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/model-manager/">Model Manager</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2020-04-23
    </span>
    
    
    <span class="post-author">::
      Pedram
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/design/">design</a>&nbsp;
    
    #<a href="/tags/code/">code</a>&nbsp;
    
  </span>
  

  

  <div class="post-content"><div>
        <p>Finding a way to get models into production seems like a universal problem these
days. <a href="https://www.google.com/search?q=models+in+production">1.75 billion results</a>
as of last count, with countless companies devoted to solving this in one way
or another.</p>
<h2 id="the-problem">The Problem<a href="#the-problem" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>At Windfall, we used a variety of models built by data scientists to drive our
products. The problem was that different people had slightly different ways
of building them, and so there was no standard way of running them.</p>
<p>We relied heavily on whoever built the model in order to run it whenever we needed
predictions. We also were exploring tying in model predictions directly into
our front-end systems. There were a few existing solutions at the time, but
after trialing them out, none really seemed easy enough to use or integrate
with our systems, so I decided to build a relatively simple solution in-house.</p>

  <img src="/img/modelmanager.png"  alt="Hello Friend"  class="left"  />


<h2 id="requirements">Requirements<a href="#requirements" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>One of our first debates was what language should the models be written in. Some
engineers suggested that we ask the data scientists to just write everything
in Python, making it easier to integrate for engineering. I felt that was a
non-starter. Asking data scientists to rewrite code didn&rsquo;t sit right.</p>
<p>Another requirement was to have something that can be used as easily by a human
as it can by a backend.</p>
<p>Finally, I wanted to hide the implementation details as much as possible, while
making the system extensible and not tightly-coupled with any particular platform.</p>
<h2 id="the-solution">The Solution<a href="#the-solution" class="hanchor" ariaLabel="Anchor">&#8983;</a> </h2>
<p>To solve the first problem, I opted for containerized approach. Data Scientists
should be free to write using whatever language they wish, so long as we could
agree on an interface. We had a couple different types of models, both real-time
and batch, and so the interface for each of these was rather straightforward.</p>
<p>On the batch side, the container should expect a dataset as an environment variable,
and it should return a location where the results will be saved as a JSON response.</p>
<p>For real time model, I opted for a simple REST interface with a few endpoints.
The client is responsible for providing the data, and the container is responsible
for returning a simple score, one for each row in the data provided.</p>
<p>Having built out the interface, the next question is where to run these containers.
Leveraging Kubernetes was an obvious choice, as we already had the power of Google&rsquo;s
managed kubernetes environment at our disposal. Batch jobs could be run on large instances
that auto-scaled down to zero to save on infrastructure costs, while real-time jobs
could be horizontally-scaled as needed to serve the required thoroughput, while
maintaining sufficient reliability.</p>
<p>The harder part is teaching a data scientist how to deploy to kubernetes. I opted
to avoid this altogether, and decided to use our CI pipeline and some helpful
bash scripts in order to automate the process. Whenever a commit was made to a
models repo, some basic checks would run, the Docker image would build, and once
a PR was accepted, the container would be pushed to our private container repo and
made available for Kubernetes to run.</p>
<p>The last missing piece was orchestrating these Kubernetes runs on-demand. Here, I built
a custom service called Model Manager. It was a two-part solution, with Flask as the backend
and VueJS on the front-end. The backend was a simple orchestrator that hid the implementation
details from the caller. It would get a list of available models through a shared
filestore, make them available for any caller through a simple API, and then fire off
requests to Kubernetes to start jobs for batch jobs, or route the request appropriately
for real-time jobs.</p>
<p>Once the backend was built, the front-end was fairly straightforward, with just
a few views that called endpoints in order to get a list of models, their status,
and also the ability to trigger a model with the click of a button.</p>

      </div></div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      <span class="button previous">
        <a href="/posts/2020-04-23-model-manager/">
          <span class="button__icon">←</span>
          <span class="button__text">2020 04 23 Model Manager</span>
        </a>
      </span>
      
      
      <span class="button next">
        <a href="/posts/shiny-babies-using-shiny-to-visualize-baby-name-trends/">
          <span class="button__text">Shiny Babies: Using Shiny to Visualize Baby Name Trends</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
